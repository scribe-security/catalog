apiVersion: v1
kind: Secret
metadata:
  name: scribe-secret
  annotations:
    tekton.dev/git-0: https://github.com
    tekton.dev/git-1: https://gitlab.com
    tekton.dev/docker-0: https://gcr.io
type: Opaque
stringData:
  client_id: ""
  client_secret: ""
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-pvc-cache
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 500m
---
apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: valint-test-pipeline
spec:
  workspaces:
  - name: shared-workspace
  tasks:
  - name: valint-bom
    taskRef:
      name: valint
    params:
    - name: args
      value: bom alpine:latest -vv
    - name: cache-dir
      value: valint-cache
    - name: scribe-secret
      value: scribe-secret
  - name: valint-verify
    taskRef:
      name: valint
    runAfter:
    - valint-bom
    params:
    - name: args
      value: verify alpine:latest -vv
    - name: cache-90dir
      value: valint-cache
    - name: scribe-secret
      value: scribe-secret
---
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: valint-test-pipeline-run
spec:
  pipelineRef:
    name: valint-test-pipeline
  workspaces:
  - name: shared-workspace
    persistentvolumeclaim:
      claimName: test-pvc-cache
  podTemplate:
    volumes:
    - name: valint-cache
      persistentVolumeClaim:
        claimName: test-pvc-cache
